<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Egg FPS Arena</title>
  <style>
    body { margin: 0; overflow: hidden; font-family: sans-serif; }
    #menu {
      position: absolute; top: 0; left: 0; right: 0; bottom: 0;
      background-color: #fafafa; display: flex;
      flex-direction: column; justify-content: center; align-items: center;
      z-index: 2;
    }
    #menu h1 { font-size: 3em; margin-bottom: 20px; }
    #playBtn {
      padding: 15px 30px; font-size: 1.5em;
      background-color: #ffc107; color: #fff;
      border: none; border-radius: 10px; cursor: pointer;
    }
    canvas { display: block; }
  </style>
</head>
<body>
  <div id="menu">
    <h1>ðŸ¥š Egg FPS Arena</h1>
    <button id="playBtn">Play</button>
  </div>
  <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/build/three.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/three@0.155.0/examples/js/controls/PointerLockControls.js"></script>
  <script>
    const scene = new THREE.Scene();
    const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
    const renderer = new THREE.WebGLRenderer();
    renderer.setSize(window.innerWidth, window.innerHeight);
    document.body.appendChild(renderer.domElement);

    const controls = new THREE.PointerLockControls(camera, document.body);
    const playBtn = document.getElementById("playBtn");
    const menu = document.getElementById("menu");

    playBtn.onclick = () => {
      menu.style.display = "none";
      controls.lock();
    };

    // Lights
    scene.add(new THREE.AmbientLight(0xffffff, 0.3));
    const light = new THREE.DirectionalLight(0xffffff, 0.8);
    light.position.set(10, 10, 5);
    scene.add(light);

    // Floor
    const floorGeometry = new THREE.PlaneGeometry(200, 200);
    const floorMaterial = new THREE.MeshLambertMaterial({ color: 0xe0d7b5 });
    const floor = new THREE.Mesh(floorGeometry, floorMaterial);
    floor.rotation.x = -Math.PI / 2;
    scene.add(floor);

    // Egg enemy
    const eggGeometry = new THREE.SphereGeometry(1, 32, 32);
    eggGeometry.scale(0.8, 1.2, 0.8); // stretch vertically to look eggy
    const eggMaterial = new THREE.MeshLambertMaterial({ color: 0x8b4513 });
    const egg = new THREE.Mesh(eggGeometry, eggMaterial);
    egg.position.set(0, 1, -10);
    scene.add(egg);

    // Bullet pool
    let bullets = [];

    // Shoot on click
    document.addEventListener('click', () => {
      if (!controls.isLocked) return;

      const bulletGeo = new THREE.SphereGeometry(0.2, 8, 8);
      const bulletMat = new THREE.MeshBasicMaterial({ color: 0xffff00 });
      const bullet = new THREE.Mesh(bulletGeo, bulletMat);
      bullet.position.copy(camera.position);
      
      const dir = new THREE.Vector3();
      camera.getWorldDirection(dir);
      bullet.userData.velocity = dir.multiplyScalar(1.5);
      scene.add(bullet);
      bullets.push(bullet);
    });

    // Movement keys
    const keys = {};
    document.addEventListener('keydown', e => keys[e.key.toLowerCase()] = true);
    document.addEventListener('keyup', e => keys[e.key.toLowerCase()] = false);

    const velocity = new THREE.Vector3();

    camera.position.set(0, 2, 0); // start height

    function animate() {
      requestAnimationFrame(animate);

      if (controls.isLocked) {
        velocity.set(0, 0, 0);
        if (keys['w']) velocity.z -= 0.1;
        if (keys['s']) velocity.z += 0.1;
        if (keys['a']) velocity.x -= 0.1;
        if (keys['d']) velocity.x += 0.1;
        controls.moveRight(velocity.x);
        controls.moveForward(velocity.z);
      }

      bullets.forEach(b => {
        b.position.add(b.userData.velocity);
      });

      renderer.render(scene, camera);
    }

    animate();
    window.addEventListener('resize', () => {
      camera.aspect = window.innerWidth/window.innerHeight;
      camera.updateProjectionMatrix();
      renderer.setSize(window.innerWidth, window.innerHeight);
    });
  </script>
</body>
</html>
